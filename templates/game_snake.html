<!DOCTYPE html>
<html>
<head>
    <title>Snake</title>
    <style>
        body { margin:0; min-height:100vh; background: linear-gradient(135deg, #0d1117 0%, #111827 100%); color:#e5e7eb; display:flex; align-items:center; justify-content:center; font-family:'Segoe UI','PingFang SC','Hiragino Sans GB',Arial,sans-serif; }
        .wrap { background: rgba(255,255,255,0.06); border:1px solid rgba(148,163,184,0.18); border-radius:12px; padding:1rem; backdrop-filter: blur(10px); }
        canvas { background:#111827; border-radius:8px; display:block; }
        .bar { display:flex; align-items:center; justify-content:space-between; margin-bottom:0.6rem; }
        a { color:#93c5fd; text-decoration:none; }
    </style>
</head>
<body>
    <div class="wrap">
        <div class="bar"><div>Snake</div><a href="/games">{{ text.back_home }}</a></div>
        <canvas id="c" width="420" height="420"></canvas>
    </div>
    <script>
        const c = document.getElementById('c');
        const ctx = c.getContext('2d');
        const size = 20; // cell size
        const cells = c.width / size;
        let snake = [{x:5,y:5}];
        let dir = {x:1,y:0};
        let food = spawn();
        let alive = true;

        function spawn(){
            return { x: Math.floor(Math.random()*cells), y: Math.floor(Math.random()*cells) };
        }
        function draw(){
            ctx.fillStyle = '#0b1220';
            ctx.fillRect(0,0,c.width,c.height);
            // food
            ctx.fillStyle = '#60a5fa';
            ctx.fillRect(food.x*size, food.y*size, size, size);
            // snake
            ctx.fillStyle = '#e5e7eb';
            snake.forEach(s=>ctx.fillRect(s.x*size, s.y*size, size, size));
        }
        function step(){
            if(!alive) return;
            const head = {x: snake[0].x + dir.x, y: snake[0].y + dir.y};
            // walls
            if (head.x<0||head.y<0||head.x>=cells||head.y>=cells) { alive=false; return; }
            // self
            if (snake.some((s,i)=>i>0&&s.x===head.x&&s.y===head.y)) { alive=false; return; }
            snake.unshift(head);
            if (head.x===food.x && head.y===food.y){ food = spawn(); }
            else snake.pop();
            draw();
        }
        draw();
        let timer = setInterval(step, 120);
        window.addEventListener('keydown', e=>{
            if (e.key==='ArrowUp' && dir.y!==1) dir={x:0,y:-1};
            else if (e.key==='ArrowDown' && dir.y!==-1) dir={x:0,y:1};
            else if (e.key==='ArrowLeft' && dir.x!==1) dir={x:-1,y:0};
            else if (e.key==='ArrowRight' && dir.x!==-1) dir={x:1,y:0};
            else if (e.key==='r') { snake=[{x:5,y:5}]; dir={x:1,y:0}; food=spawn(); alive=true; draw(); }
        });
    </script>
</body>
</html>


